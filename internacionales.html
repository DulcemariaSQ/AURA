<script>
  // Carrusel: cambia cada 5 segundos
  let currentSlide = 0;
  const slides = document.querySelectorAll('.carousel img');
  const totalSlides = slides.length;
  function showSlide(index) {
    slides.forEach((slide, i) => {
      slide.classList.toggle('active', i === index);
    });
  }
  function nextSlide() {
    currentSlide = (currentSlide + 1) % totalSlides;
    showSlide(currentSlide);
  }
  setInterval(nextSlide, 5000);

  // Función para marcar la talla seleccionada
  function selectSize(button) {
    const container = button.parentElement;
    Array.from(container.children).forEach(btn => btn.classList.remove('active-size'));
    button.classList.add('active-size');
  }

  // Simulación simple de carrito: suma el precio de cada producto agregado
  let cartTotal = 0;
  function addToCart(btn, price) {
    const productCard = btn.closest('.product-card');
    const sizeButtons = productCard.querySelectorAll('.size-buttons button');
    const selectedSizeBtn = Array.from(sizeButtons).find(button => button.classList.contains('active-size'));
    if (!selectedSizeBtn) {
      alert("SELECCIONE LA TALLA POR FAVOR");
      return;
    }
    
    // Incrementar el total (opcional si deseas mantener esta funcionalidad)
    cartTotal += price;
    alert("Producto agregado. Total en carrito: S/. " + cartTotal);
    
    // Obtener datos del producto
    const productName = productCard.querySelector("h3").textContent;
    const productImg = productCard.querySelector("img").src;
    const productSize = selectedSizeBtn.textContent;

    const productData = {
      name: productName,
      price: price,
      size: productSize,
      img: productImg
    };

    // Obtener el carrito actual del localStorage o crear uno nuevo si no existe
    let cart = JSON.parse(localStorage.getItem("cart")) || [];

    // Agregar el nuevo producto
    cart.push(productData);

    // Guardar el carrito actualizado en el localStorage
    localStorage.setItem("cart", JSON.stringify(cart));
  }

  // Función para filtrar productos por subcategoría
  function filterProducts(category) {
    const buttons = document.querySelectorAll('.subcategories button');
    buttons.forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');

    const products = document.querySelectorAll('.product-card');
    products.forEach(product => {
      if (category === 'ALL') {
        product.style.display = 'block';
      } else {
        if (product.getAttribute('data-category') === category) {
          product.style.display = 'block';
        } else {
          product.style.display = 'none';
        }
      }
    });
  }
</script>
